<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bookings - MPH Booking System</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
    <!-- Header -->
    <div id="header-placeholder"></div>
    
    <!-- Main Content -->
    <main class="main-content">
        <div class="content-container">
            <!-- Page Title Section -->
            <div class="page-header">
                <div class="page-header-content-center">
                    <h1 class="page-title">Book Your Session</h1>
                    <p class="page-subtitle">Select a sport and find available time slots for the upcoming weeks</p>
                </div>
            </div>
            
            <!-- Booking Search Bar -->
            <div class="booking-search-wrapper">
                <div class="booking-search-bar">
                    <!-- Sport Section -->
                    <div class="search-section sport-section" id="sportSection">
                        <div class="section-label">Sport</div>
                        <div class="section-value" id="sportValue">
                            <span class="placeholder">Select a sport</span>
                        </div>
                        <!-- Sport Dropdown -->
                        <div class="sport-dropdown" id="sportDropdown" style="display: none;">
                            <div class="sport-option" data-sport="basketball" data-emoji="üèÄ">
                                <span class="sport-emoji">üèÄ</span>
                                <span>Basketball</span>
                            </div>
                            <div class="sport-option" data-sport="badminton" data-emoji="üè∏">
                                <span class="sport-emoji">üè∏</span>
                                <span>Badminton</span>
                            </div>
                            <div class="sport-option" data-sport="volleyball" data-emoji="üèê">
                                <span class="sport-emoji">üèê</span>
                                <span>Volleyball</span>
                            </div>
                        </div>
                    </div>

                    <div class="section-divider"></div>

                    <!-- When Section -->
                    <div class="search-section when-section" id="whenSection">
                        <div class="section-label">When</div>
                        <div class="section-value" id="whenValue">
                            <span class="placeholder">Pick a date</span>
                        </div>
                        <!-- When Dropdown -->
                        <div class="when-dropdown" id="whenDropdown" style="display: none;">
                            <div class="when-dropdown-content">
                                <div class="dropdown-field">
                                    <label class="dropdown-label">Date</label>
                                    <input type="date" id="dateSelect" class="dropdown-date-input">
                                </div>
                                <div class="dropdown-field">
                                    <label class="dropdown-label">Start time & duration</label>
                                    <div class="time-row">
                                        <select id="timeHourSelect" class="dropdown-select">
                                            <option value="">Select</option>
                                            <option value="12">12:00</option>
                                            <option value="1">1:00</option>
                                            <option value="2">2:00</option>
                                            <option value="3">3:00</option>
                                            <option value="4">4:00</option>
                                            <option value="5">5:00</option>
                                            <option value="6">6:00</option>
                                            <option value="7">7:00</option>
                                            <option value="8">8:00</option>
                                            <option value="9">9:00</option>
                                            <option value="10">10:00</option>
                                            <option value="11">11:00</option>
                                        </select>
                                        <select id="periodSelect" class="dropdown-select dropdown-select-small">
                                            <option value="AM">AM</option>
                                            <option value="PM">PM</option>
                                        </select>
                                        <select id="durationSelect" class="dropdown-select">
                                            <option value="">Select</option>
                                            <option value="1">1 Hour</option>
                                            <option value="2">2 Hours</option>
                                            <option value="3">3 Hours</option>
                                            <option value="4">4 Hours</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Search Button -->
                    <button type="button" id="searchBtn" class="search-btn" disabled>
                        <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                        <span class="search-text">Search</span>
                    </button>
                </div>
            </div>

            <!-- Featured Courts Section -->
            <div class="featured-section">
                <div class="featured-header">
                    <h2 class="featured-title">Featured Courts</h2>
                    <p class="featured-subtitle">Student-friendly pricing for your next game</p>
                </div>
                <div class="featured-grid">
                    <div class="feature-card">
                        <div class="feature-icon">üèÄ</div>
                        <h3 class="feature-card-title">Basketball Courts</h3>
                        <p class="feature-card-desc">Half courts and full court options with professional-grade hardwood flooring</p>
                        <div class="feature-card-price">
                            <span class="price-from">From</span>
                            <span class="price-value">‚Ç¨8</span>
                            <span class="price-unit">/hour</span>
                        </div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üè∏</div>
                        <h3 class="feature-card-title">Badminton Courts</h3>
                        <p class="feature-card-desc">4 premium courts with high ceilings and professional lighting</p>
                        <div class="feature-card-price">
                            <span class="price-from">From</span>
                            <span class="price-value">‚Ç¨5</span>
                            <span class="price-unit">/hour</span>
                        </div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üèê</div>
                        <h3 class="feature-card-title">Volleyball Court</h3>
                        <p class="feature-card-desc">Regulation-size court with professional-grade flooring</p>
                        <div class="feature-card-price">
                            <span class="price-from">From</span>
                            <span class="price-value">‚Ç¨12</span>
                            <span class="price-unit">/hour</span>
                        </div>
                    </div>
                </div>
            </div>

            
            <!-- Calendar Section -->
            <div class="calendar-section" style="display: none;">
                <!-- Loading Indicator -->
                <div class="loading-indicator" id="loadingIndicator">
                    <div class="spinner"></div>
                    <p>Loading availability...</p>
                </div>
                
                <!-- Calendar Results Container -->
                <div class="calendar-container" id="calendarContainer" style="display: none;">
                    <div id="calendarGrid">
                        <!-- Availability table will be generated by JS -->
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Booking Confirmation Modal -->
    <div class="modal-overlay" id="bookingModal" style="display: none;">
        <div class="modal-container">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                    </div>
                    <h3 class="modal-title" id="modalTitle">Confirm Your Booking</h3>
                    <p class="modal-subtitle" id="modalSubtitle">Please review your booking details</p>
                </div>
                
                <div class="modal-body">
                    <div class="booking-detail">
                        <span class="detail-icon" id="modalSportIcon">üèÄ</span>
                        <div class="detail-content">
                            <span class="detail-label">Sport</span>
                            <span class="detail-value" id="modalSport">-</span>
                        </div>
                    </div>
                    <div class="booking-detail">
                        <span class="detail-icon">üèüÔ∏è</span>
                        <div class="detail-content">
                            <span class="detail-label">Court</span>
                            <span class="detail-value" id="modalCourt">-</span>
                        </div>
                    </div>
                    <div class="booking-detail">
                        <span class="detail-icon">üìÖ</span>
                        <div class="detail-content">
                            <span class="detail-label">Date</span>
                            <span class="detail-value" id="modalDate">-</span>
                        </div>
                    </div>
                    <div class="booking-detail">
                        <span class="detail-icon">‚è∞</span>
                        <div class="detail-content">
                            <span class="detail-label">Time</span>
                            <span class="detail-value" id="modalTime">-</span>
                        </div>
                    </div>
                    <div class="booking-detail">
                        <span class="detail-icon">‚è≥</span>
                        <div class="detail-content">
                            <span class="detail-label">Duration</span>
                            <span class="detail-value" id="modalDuration">-</span>
                        </div>
                    </div>
                    <div class="booking-detail booking-detail-price">
                        <span class="detail-icon">üí∞</span>
                        <div class="detail-content">
                            <span class="detail-label">Total Price</span>
                            <span class="detail-value detail-value-price" id="modalPrice">-</span>
                        </div>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button class="modal-btn modal-btn-cancel" id="modalCancelBtn">Cancel</button>
                    <button class="modal-btn modal-btn-confirm" id="modalConfirmBtn">Confirm Booking</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Success Modal -->
    <div class="modal-overlay" id="successModal" style="display: none;">
        <div class="modal-container modal-container-success">
            <div class="modal-content">
                <div class="modal-header modal-header-success">
                    <div class="modal-icon modal-icon-success">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                        </svg>
                    </div>
                    <h3 class="modal-title">Booking Confirmed!</h3>
                    <p class="modal-subtitle">Your court has been successfully reserved</p>
                </div>
                
                <div class="modal-body">
                    <p class="success-message">
                        You'll receive a confirmation email shortly. Check "My Bookings" in your profile to view all reservations.
                    </p>
                </div>
                
                <div class="modal-footer">
                    <button class="modal-btn modal-btn-primary" id="successOkBtn">Got it!</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <div id="footer-placeholder"></div>
    
    <!-- Scripts -->
    <script src="../js/calendar.js"></script>
    <script src="../js/navigation.js"></script>
    <script>
        // Load header and footer
        fetch('../../partials/header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-placeholder').innerHTML = data;
                setActiveNav('booking.html');
                
                // Setup profile dropdown after header loads
                setupProfileDropdown();
            });
        
        fetch('../../partials/footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer-placeholder').innerHTML = data;
            });
        
        // Profile dropdown handler
        function setupProfileDropdown() {
            const profileBtn = document.getElementById('profileBtn');
            const profileDropdown = document.getElementById('profileDropdown');
            const myBookingsBtn = document.getElementById('myBookingsBtn');
            
            if (profileBtn && profileDropdown) {
                profileBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const isVisible = profileDropdown.style.display === 'block';
                    profileDropdown.style.display = isVisible ? 'none' : 'block';
                });
                
                document.addEventListener('click', (e) => {
                    if (!profileBtn.contains(e.target) && !profileDropdown.contains(e.target)) {
                        profileDropdown.style.display = 'none';
                    }
                });
            }
            
            if (myBookingsBtn) {
                myBookingsBtn.addEventListener('click', () => {
                    window.location.href = 'my-bookings.html';
                });
            }
        }
    </script>
</body>
</html>
